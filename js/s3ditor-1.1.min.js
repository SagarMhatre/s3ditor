function S3ditor(){this.fileList=null,this.bucket=null,this.bucketName=null,this.currentFile=null,this.requestedFileKey=null,this.setRequestedFileKey=function(e){this.requestedFileKey=e},this.init=function(e,t,i,n){this.bucketName=n;var s={};s.accessKeyId=e,s.secretAccessKey=t,AWS.config.update(s),AWS.config.region=i,this.bucket=new AWS.S3({params:{Bucket:this.bucketName}}),this.fileList=null},this.loadFileListFromS3=function(){var e={Bucket:this.bucketName};this.bucket.listObjects(e,function(e,t){if(e)uiHandler.getInstance().showLoginDialog(),uiHandler.getInstance().showErrorMessageDialog(e);else{for(var i=[],n=0;n<t.Contents.length;n++)i[n]=t.Contents[n].Key;s3ditor.getInstance().setBucketFileList(i.sort()),uiHandler.getInstance().showDirectory()}})},this.getBucketFileList=function(){return this.fileList},this.getBucketName=function(){return this.bucketName},this.setBucketFileList=function(e){this.fileList=e},this.setCurrentFile=function(e){this.currentFile=e,this.currentFile.Key=this.requestedFileKey,this.requestedFileKey=null,uiHandler.getInstance().showeditor(this.currentFile.ContentType,this.currentFile.Body.toString("ascii"))},this.getCurrentFile=function(e){return this.currentFile},this.save=function(e){if(this.currentFile.Key){var t=this.currentFile;t.Bucket=this.bucketName,t.Body=e;var i=new AWS.S3;i.upload(t,function(e,t){e?uiHandler.getInstance().showErrorMessageDialog(e):uiHandler.getInstance().showMessageDialog("Success","File Saved succesfully",!0)})}else uiHandler.getInstance().showMessageDialog("Error","No Current File Selected",!0)},this.loadFileContents=function(e){var t={Bucket:this.bucketName,Key:e},i=new AWS.S3;this.setRequestedFileKey(e),i.getObject(t,function(e,t){e?uiHandler.getInstance().showErrorMessageDialog(e):s3ditor.getInstance().setCurrentFile(t)})},this.close=function(){this.bucket=null,this.bucketName=null,this.currentFile=null}}var s3ditor=function(){function e(){var e=new S3ditor;return e}var t;return{getInstance:function(){return t||(t=e()),t}}}();
